EM算法：

E-step：根据参数的初始值或上一次迭代的模型参数来计算出的隐性变量的后验概率（条件概率），其实就是隐性变量的期望值。作为隐藏变量的现有估计值

$Q_{\mathrm{i}}\left(z^{(\mathrm{i})}\right)=p\left(z^{(\mathrm{i})} | x^{(\mathrm{i})} ; \theta\right)$

M-step：最大化似然函数从而获得新的参数值

$\theta=\arg \max _{\theta} \sum_{i} \sum_{z^{(i)}} Q_{i}\left(z^{(i)}\right) \log \frac{p\left(x^{(i)}, z^{(i)} ; \theta\right)}{Q_{i}\left(z^{(i)}\right)}$





举个例子来说明如何使用EM算法

我们以抛硬币来举例，一个正常的抛硬币实验是，分别抛了两次硬币A和硬币B，得到了结果如下：

| 硬币 | 结果       | 统计    |
| ---- | ---------- | ------- |
| A    | 正正反正反 | 3正-2反 |
| B    | 反反正正反 | 2正-3反 |
| A    | 正反反反反 | 1正-4反 |
| B    | 正反反正正 | 3正-2反 |

我们可以通过实验结果得出硬币A、B正面朝上的概率

$P(A) = \frac{(3+1)}{10} = 0.4$

$P(B) = \frac{2+3}{10} = 0.5$



EM方法是要解决的是带有隐变量的问题，即我们不知道每次抛的是硬币A还是B：

| 硬币    | 结果       | 统计    |
| ------- | ---------- | ------- |
| unknown | 正正反正反 | 3正-2反 |
| unknown | 反反正正反 | 2正-3反 |
| unknown | 正反反反反 | 1正-4反 |
| unknown | 正反反正正 | 3正-2反 |

在这个问题中，隐变量 $z$ 表示每一次抛的是硬币A还是B，$z=(z_1,z_2,z_3,z_4)$

我们要估计的目标参数 $\theta$ 是硬币A和B正面朝上的概率，$\theta=(\theta_A,\theta_B)$ 

观测量 $x$ 是实验的结果

根据EM算法，首先初始化一个 $\theta$ 值，我们假设 $P(A)=0.4$  $P(B)=0.6$

紧接着是E步骤，求出Q

在第一个实验中

如果是硬币A，得出3正2反的概率为：$0.4^3×0.6^2=0.02304$

如果是硬币B，得出3正2反的概率为：$0.6^3×0.4^2=0.03456$ 

两者比较，我们当然选择希望更大的那个，所以得到第一次试验的 $z_1=B$  



同理我们得到了 $z_2 = $











compare $i$  with  $\mathrm{i}$ ,one is normal and the other is \mathrm



 